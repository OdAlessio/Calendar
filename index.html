<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–î–æ–¥–∞—Ç–∏ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #1a1a2e;
  color: #e0e0e0;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
}
.card {
  background: #16213e;
  border-radius: 16px;
  padding: 28px 24px;
  max-width: 400px;
  width: 100%;
  text-align: center;
  box-shadow: 0 8px 32px rgba(0,0,0,.3);
}
.icon { font-size: 48px; margin-bottom: 12px; }
h1 { font-size: 20px; margin-bottom: 16px; color: #fff; }
.info { text-align: left; margin: 16px 0; }
.info div { padding: 8px 0; border-bottom: 1px solid #ffffff15; }
.info div:last-child { border: none; }
.label { font-size: 13px; color: #888; }
.value { font-size: 15px; color: #fff; margin-top: 2px; }
.value a { color: #0a84ff; text-decoration: none; }
.value a:hover { text-decoration: underline; }
.btn {
  display: block;
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  margin-top: 10px;
  text-decoration: none;
  text-align: center;
}
.btn-apple { background: #0a84ff; color: #fff; }
.btn-google { background: #34a853; color: #fff; }
.btn-copy { background: #ff9500; color: #fff; }
.btn:active { opacity: .8; }
.tg-banner {
  background: #2a1a00;
  border: 1px solid #ff950055;
  border-radius: 12px;
  padding: 14px 16px;
  margin-bottom: 16px;
  text-align: left;
  font-size: 14px;
  color: #ffcc80;
  display: none;
}
.tg-banner b { color: #ffb74d; }
.tg-banner .steps {
  margin-top: 8px;
  font-size: 13px;
  color: #cca060;
  line-height: 1.5;
}
.copied-msg {
  display: none;
  color: #4caf50;
  font-size: 14px;
  font-weight: 600;
  margin-top: 8px;
}
.cosmetolog {
  margin-top: 16px;
  font-size: 13px;
  color: #888;
}
.cosmetolog a { color: #aaa; text-decoration: none; }
</style>
</head>
<body>
<div class="card">
  <div id="tgBanner" class="tg-banner">
    <b>‚ö†Ô∏è –í–∏ –≤—ñ–¥–∫—Ä–∏–ª–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤ Telegram</b>
    <div class="steps">
      –î–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä —Å–∫–æ–ø—ñ—é–π—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ –≤ Safari –∞–±–æ Chrome:
    </div>
  </div>
  <div class="icon">üìÖ</div>
  <h1>–ó–∞–ø–∏—Å –¥–æ –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∞ dr_gulvakova</h1>
  <div class="info">
    <div>
      <div class="label">–ü–æ—Å–ª—É–≥–∞</div>
      <div class="value" id="srv">‚Äî</div>
    </div>
    <div>
      <div class="label">–î–∞—Ç–∞</div>
      <div class="value" id="dt">‚Äî</div>
    </div>
    <div>
      <div class="label">–ß–∞—Å</div>
      <div class="value" id="tm">‚Äî</div>
    </div>
    <div id="locRow" style="display:none">
      <div class="label">–õ–æ–∫–∞—Ü—ñ—è</div>
      <div class="value"><a id="locLink" href="#" target="_blank">üìç –í—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—ñ</a></div>
    </div>
  </div>

  <button class="btn btn-copy" id="btnCopy" style="display:none" onclick="copyLink()">üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
  <div class="copied-msg" id="copiedMsg">‚úÖ –ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!</div>

  <a class="btn btn-apple" id="btnApple" href="#">üçé –î–æ–¥–∞—Ç–∏ –≤ Apple Calendar</a>
  <a class="btn btn-google" id="btnGoogle" href="#" target="_blank">üìÖ –î–æ–¥–∞—Ç–∏ –≤ Google Calendar</a>
  <div class="cosmetolog">–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥: <a href="https://instagram.com/dr_gulvakova" target="_blank">instagram.com/dr_gulvakova</a></div>
</div>
<script>
function copyLink(){
  var url = window.location.href;
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(url).then(function(){
      showCopied();
    });
  } else {
    var ta = document.createElement('textarea');
    ta.value = url;
    ta.style.position = 'fixed';
    ta.style.opacity = '0';
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    showCopied();
  }
}
function showCopied(){
  var m = document.getElementById('copiedMsg');
  m.style.display = 'block';
  setTimeout(function(){ m.style.display = 'none'; }, 3000);
}

(function(){
  var p = new URLSearchParams(window.location.search);
  var title = p.get('t') || '–í—ñ–∑–∏—Ç';
  var start = p.get('s') || '';
  var end   = p.get('e') || '';
  var desc  = p.get('d') || '';
  var loc   = p.get('l') || '';

  // Detect Telegram WebView
  var isTg = (typeof TelegramWebviewProxy !== 'undefined') ||
             (navigator.userAgent.indexOf('Telegram') !== -1) ||
             (window.TelegramWebview !== undefined);

  if(isTg){
    document.getElementById('tgBanner').style.display = 'block';
    document.getElementById('btnCopy').style.display = 'block';
  }

  // Display info
  document.getElementById('srv').textContent = title;
  if(start){
    var sd = new Date(start.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})Z/,'$1-$2-$3T$4:$5:$6Z'));
    var ed = end ? new Date(end.replace(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})Z/,'$1-$2-$3T$4:$5:$6Z')) : sd;
    var opts = {day:'2-digit',month:'2-digit',year:'numeric',timeZone:'Europe/Kyiv'};
    var topts = {hour:'2-digit',minute:'2-digit',timeZone:'Europe/Kyiv',hour12:false};
    document.getElementById('dt').textContent = sd.toLocaleDateString('uk-UA', opts);
    document.getElementById('tm').textContent = sd.toLocaleTimeString('uk-UA', topts) + '‚Äì' + ed.toLocaleTimeString('uk-UA', topts);
  }

  // Location
  var locDisplay = loc || '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥';
  if(loc){
    document.getElementById('locRow').style.display = '';
    document.getElementById('locLink').href = loc;
  }

  // ICS ‚Äî data: URI (works better in WebViews than blob:)
  var ics = [
    'BEGIN:VCALENDAR',
    'VERSION:2.0',
    'PRODID:-//CosmetologBot//UA',
    'CALSCALE:GREGORIAN',
    'METHOD:PUBLISH',
    'BEGIN:VEVENT',
    'UID:visit-' + Date.now() + '@cosmetolog-bot',
    'DTSTAMP:' + start,
    'DTSTART:' + start,
    'DTEND:' + (end || start),
    'SUMMARY:' + title,
    'DESCRIPTION:' + desc.replace(/\n/g,'\\n'),
    'LOCATION:' + locDisplay,
    'STATUS:CONFIRMED',
    'BEGIN:VALARM',
    'TRIGGER:-P1D',
    'ACTION:DISPLAY',
    'DESCRIPTION:–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: –∑–∞–≤—Ç—Ä–∞ —É –≤–∞—Å –∑–∞–ø–∏—Å –¥–æ –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∞',
    'END:VALARM',
    'BEGIN:VALARM',
    'TRIGGER:-PT2H',
    'ACTION:DISPLAY',
    'DESCRIPTION:–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: —á–µ—Ä–µ–∑ 2 –≥–æ–¥–∏–Ω–∏ —É –≤–∞—Å –∑–∞–ø–∏—Å –¥–æ –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∞',
    'END:VALARM',
    'END:VEVENT',
    'END:VCALENDAR'
  ].join('\r\n');

  var dataUri = 'data:text/calendar;charset=utf-8,' + encodeURIComponent(ics);

  document.getElementById('btnApple').href = dataUri;
  document.getElementById('btnApple').download = 'zapys.ics';

  // Google Calendar
  var gcal = 'https://calendar.google.com/calendar/render?action=TEMPLATE'
    + '&text=' + encodeURIComponent(title)
    + '&dates=' + start + '/' + (end||start)
    + '&details=' + encodeURIComponent(desc)
    + '&location=' + encodeURIComponent(locDisplay);
  document.getElementById('btnGoogle').href = gcal;

  // iOS outside Telegram: auto trigger
  var isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
  if(isIOS && !isTg){
    setTimeout(function(){
      window.location.href = dataUri;
    }, 500);
  }
})();
</script>
</body>
</html>
